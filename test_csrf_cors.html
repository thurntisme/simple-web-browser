<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="abc123def456ghi789jkl012mno345pqr678stu901vwx234yz">
    <meta name="_token" content="xyz789abc123def456ghi789jkl012mno345pqr678stu901vwx">
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com;">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <title>üõ°Ô∏è CSRF/CORS Visual Tester Demo</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px 0;
        }

        .container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
            margin: 20px auto;
        }

        .security-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #28a745;
            transition: transform 0.2s ease;
        }

        .security-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .vulnerability-card {
            border-left-color: #dc3545;
            background: #fff5f5;
        }

        .warning-card {
            border-left-color: #ffc107;
            background: #fffbf0;
        }

        .test-form {
            background: #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #dee2e6;
        }

        .alert-custom {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            border-left: 4px solid #17a2b8;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 10px 0;
            overflow-x: auto;
        }

        .security-status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            margin: 5px;
        }

        .status-secure {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .status-vulnerable {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="text-center mb-5">
            <h1 class="display-4 mb-3">üõ°Ô∏è CSRF/CORS Visual Tester Demo</h1>
            <p class="lead">A comprehensive demonstration page for testing CSRF and CORS security policies</p>
        </div>

        <div class="alert-custom">
            <h4><i class="fas fa-shield-alt"></i> How to Use the CSRF/CORS Visual Tester</h4>
            <p class="mb-0">
                <strong>Right-click anywhere on this page</strong> and select <strong>"üõ°Ô∏è CSRF/CORS Visual
                    Tester"</strong>
                to analyze the security policies and protections implemented on this page.
            </p>
        </div>

        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card text-center">
                    <div class="card-body">
                        <i class="fas fa-shield-alt fa-3x text-success mb-3"></i>
                        <h5>CSRF Protection</h5>
                        <p class="card-text">Cross-Site Request Forgery protection tokens detected</p>
                        <span class="status-secure">‚úÖ Protected</span>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center">
                    <div class="card-body">
                        <i class="fas fa-globe fa-3x text-primary mb-3"></i>
                        <h5>CORS Policy</h5>
                        <p class="card-text">Cross-Origin Resource Sharing configuration</p>
                        <span class="status-warning">‚ö†Ô∏è Limited Detection</span>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center">
                    <div class="card-body">
                        <i class="fas fa-lock fa-3x text-success mb-3"></i>
                        <h5>Security Headers</h5>
                        <p class="card-text">Various security headers implemented</p>
                        <span class="status-secure">‚úÖ Present</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="demo-grid">
            <div class="security-card">
                <h4><i class="fas fa-user-shield"></i> CSRF Protection</h4>
                <p>This page includes multiple CSRF protection mechanisms:</p>
                <ul>
                    <li><strong>Meta CSRF Token:</strong> <code>csrf-token</code> in page head</li>
                    <li><strong>Alternative Token:</strong> <code>_token</code> meta tag</li>
                    <li><strong>Form Tokens:</strong> Hidden inputs in forms below</li>
                </ul>
                <div class="code-block">
                    &lt;meta name="csrf-token" content="abc123..."&gt;
                    &lt;input type="hidden" name="_token" value="xyz789..."&gt;
                </div>
            </div>

            <div class="security-card">
                <h4><i class="fas fa-server"></i> Security Headers</h4>
                <p>Multiple security headers are configured:</p>
                <ul>
                    <li><strong>Content-Security-Policy:</strong> Restricts resource loading</li>
                    <li><strong>X-Frame-Options:</strong> Prevents clickjacking (DENY)</li>
                    <li><strong>Referrer-Policy:</strong> Controls referrer information</li>
                </ul>
                <span class="status-secure">All headers present</span>
            </div>

            <div class="warning-card">
                <h4><i class="fas fa-exclamation-triangle"></i> CORS Limitations</h4>
                <p>CORS detection has browser limitations:</p>
                <ul>
                    <li>CORS headers are server-side configurations</li>
                    <li>Browser security restricts client-side detection</li>
                    <li>Some tests may show limited results</li>
                </ul>
                <span class="status-warning">Limited client-side detection</span>
            </div>

            <div class="security-card">
                <h4><i class="fas fa-certificate"></i> HTTPS Security</h4>
                <p>Connection security status:</p>
                <ul>
                    <li id="https-status">Checking HTTPS status...</li>
                    <li id="mixed-content-status">Checking mixed content...</li>
                    <li id="protocol-status">Checking protocol...</li>
                </ul>
            </div>
        </div>

        <h3 class="mt-5 mb-3"><i class="fas fa-vial"></i> Test Forms</h3>
        <p>The following forms demonstrate different CSRF protection scenarios:</p>

        <!-- Protected Form 1 -->
        <div class="test-form">
            <h5><i class="fas fa-shield-alt text-success"></i> Protected Form #1 (Login)</h5>
            <form action="/login" method="POST">
                <input type="hidden" name="_token" value="csrf_token_123456789abcdef">
                <input type="hidden" name="csrf_token" value="another_token_987654321fedcba">

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="username1" class="form-label">Username</label>
                            <input type="text" class="form-control" id="username1" name="username" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="password1" class="form-label">Password</label>
                            <input type="password" class="form-control" id="password1" name="password" required>
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <span class="status-secure ms-2">‚úÖ CSRF Protected</span>
            </form>
        </div>

        <!-- Protected Form 2 -->
        <div class="test-form">
            <h5><i class="fas fa-shield-alt text-success"></i> Protected Form #2 (Contact)</h5>
            <form action="/contact" method="POST">
                <input type="hidden" name="_token" value="contact_form_token_abcdef123456">

                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="name2" class="form-label">Name</label>
                            <input type="text" class="form-control" id="name2" name="name" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="email2" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email2" name="email" required>
                        </div>
                    </div>
                </div>

                <div class="mb-3">
                    <label for="message2" class="form-label">Message</label>
                    <textarea class="form-control" id="message2" name="message" rows="3" required></textarea>
                </div>

                <button type="submit" class="btn btn-success">
                    <i class="fas fa-paper-plane"></i> Send Message
                </button>
                <span class="status-secure ms-2">‚úÖ CSRF Protected</span>
            </form>
        </div>

        <!-- Vulnerable Form -->
        <div class="test-form" style="background: #fff5f5; border-left: 4px solid #dc3545;">
            <h5><i class="fas fa-exclamation-triangle text-danger"></i> Vulnerable Form #3 (Newsletter)</h5>
            <p class="text-danger"><small><i class="fas fa-info-circle"></i> This form intentionally lacks CSRF
                    protection for demonstration</small></p>
            <form action="/newsletter" method="POST">
                <!-- No CSRF token here -->

                <div class="row">
                    <div class="col-md-8">
                        <div class="mb-3">
                            <label for="email3" class="form-label">Email Address</label>
                            <input type="email" class="form-control" id="email3" name="email" required>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-3">
                            <label class="form-label">&nbsp;</label>
                            <button type="submit" class="btn btn-warning w-100">
                                <i class="fas fa-envelope"></i> Subscribe
                            </button>
                        </div>
                    </div>
                </div>
                <span class="status-vulnerable">‚ùå No CSRF Protection</span>
            </form>
        </div>

        <!-- GET Form (typically doesn't need CSRF) -->
        <div class="test-form" style="background: #f0f8ff; border-left: 4px solid #007bff;">
            <h5><i class="fas fa-search text-primary"></i> Search Form (GET Method)</h5>
            <p class="text-primary"><small><i class="fas fa-info-circle"></i> GET forms typically don't require CSRF
                    protection</small></p>
            <form action="/search" method="GET">
                <div class="row">
                    <div class="col-md-8">
                        <div class="mb-3">
                            <label for="query" class="form-label">Search Query</label>
                            <input type="text" class="form-control" id="query" name="q"
                                placeholder="Enter search terms...">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-3">
                            <label class="form-label">&nbsp;</label>
                            <button type="submit" class="btn btn-primary w-100">
                                <i class="fas fa-search"></i> Search
                            </button>
                        </div>
                    </div>
                </div>
                <span class="status-secure">‚úÖ GET Method (No CSRF needed)</span>
            </form>
        </div>

        <div class="alert alert-info mt-5">
            <h4><i class="fas fa-lightbulb"></i> What the Tester Will Detect</h4>
            <div class="row">
                <div class="col-md-6">
                    <h6>CSRF Protection:</h6>
                    <ul class="mb-0">
                        <li>Meta CSRF tokens in page head</li>
                        <li>Hidden CSRF inputs in forms</li>
                        <li>Form protection status</li>
                        <li>Token naming conventions</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h6>Security Headers:</h6>
                    <ul class="mb-0">
                        <li>Content Security Policy (CSP)</li>
                        <li>X-Frame-Options</li>
                        <li>Referrer Policy</li>
                        <li>HTTPS enforcement</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="text-center mt-5">
            <h3>üéØ Ready to Test?</h3>
            <p class="lead">
                Right-click anywhere on this page and select <strong>"üõ°Ô∏è CSRF/CORS Visual Tester"</strong>
                to see a comprehensive security analysis!
            </p>
            <div class="mt-3">
                <span class="status-secure">2 CSRF Tokens</span>
                <span class="status-secure">4 Forms</span>
                <span class="status-secure">3 Security Headers</span>
                <span class="status-warning">CORS Limited</span>
            </div>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Update security status dynamically
        document.addEventListener('DOMContentLoaded', function () {
            // Check HTTPS status
            const httpsStatus = document.getElementById('https-status');
            if (window.location.protocol === 'https:') {
                httpsStatus.innerHTML = '<i class="fas fa-check text-success"></i> HTTPS: Enabled';
            } else {
                httpsStatus.innerHTML = '<i class="fas fa-times text-danger"></i> HTTPS: Disabled';
            }

            // Check for mixed content
            const mixedContentStatus = document.getElementById('mixed-content-status');
            const httpResources = document.querySelectorAll('script[src^="http:"], link[href^="http:"], img[src^="http:"]');
            if (httpResources.length > 0 && window.location.protocol === 'https:') {
                mixedContentStatus.innerHTML = '<i class="fas fa-exclamation-triangle text-warning"></i> Mixed Content: Issues detected';
            } else {
                mixedContentStatus.innerHTML = '<i class="fas fa-check text-success"></i> Mixed Content: No issues';
            }

            // Show protocol
            const protocolStatus = document.getElementById('protocol-status');
            protocolStatus.innerHTML = `<i class="fas fa-info-circle text-info"></i> Protocol: ${window.location.protocol}`;

            console.log('üõ°Ô∏è CSRF/CORS Demo Page Loaded');
            console.log('- CSRF tokens: 2 meta tags detected');
            console.log('- Forms: 4 forms (3 POST, 1 GET)');
            console.log('- Security headers: CSP, X-Frame-Options, Referrer-Policy');
            console.log('- HTTPS status:', window.location.protocol === 'https:' ? 'Enabled' : 'Disabled');

            // Simulate some security-related JavaScript
            if (typeof fetch !== 'undefined') {
                console.log('- Fetch API: Available for CORS testing');
            }

            // Add some cookies for testing
            document.cookie = "session_id=demo_session_123; path=/; secure; samesite=strict";
            document.cookie = "csrf_cookie=csrf_demo_456; path=/; secure; samesite=lax";
            document.cookie = "user_prefs=theme_dark; path=/";
        });

        // Simulate CORS-related functionality
        function simulateCORSRequest() {
            console.log('Simulating CORS request...');
            // This would typically be blocked by CORS policy
            fetch('https://api.example.com/data', {
                method: 'GET',
                mode: 'cors',
                credentials: 'include'
            }).then(response => {
                console.log('CORS request successful');
            }).catch(error => {
                console.log('CORS request blocked:', error.message);
            });
        }

        // Add event listeners to forms for demonstration
        document.querySelectorAll('form').forEach((form, index) => {
            form.addEventListener('submit', function (e) {
                e.preventDefault();
                const hasCSRF = form.querySelector('input[name*="token"], input[name*="csrf"]');
                console.log(`Form ${index + 1} submission:`, {
                    action: form.action,
                    method: form.method,
                    csrfProtected: !!hasCSRF
                });

                alert(`Form ${index + 1} would be submitted with ${hasCSRF ? 'CSRF protection' : 'NO CSRF protection'}`);
            });
        });
    </script>
</body>

</html>